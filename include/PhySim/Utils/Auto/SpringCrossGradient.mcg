		double t1 = x2[0]-x1[0];
		double t2 = t1*t1;
		double t3 = x2[1]-x1[1];
		double t4 = t3*t3;
		double t5 = x2[2]-x1[2];
		double t6 = t5*t5;
		double t8 = sqrt(t2+t4+t6);
		double t9 = x4[0]-x3[0];
		double t10 = t9*t9;
		double t11 = x4[1]-x3[1];
		double t12 = t11*t11;
		double t13 = x4[2]-x3[2];
		double t14 = t13*t13;
		double t16 = sqrt(t10+t12+t14);
		double t18 = K*(t8-t16-R0);
		double t20 = L0/t8;
		double t40 = L0/t16;
      vgx[0] = -0.1E1*t18*t20*t1;
      vgx[1] = -0.1E1*t18*t20*t3;
      vgx[2] = -0.1E1*t18*t20*t5;
      vgx[3] = 0.1E1*t18*t20*t1;
      vgx[4] = 0.1E1*t18*t20*t3;
      vgx[5] = 0.1E1*t18*t20*t5;
      vgx[6] = 0.1E1*t18*t40*t9;
      vgx[7] = 0.1E1*t18*t40*t11;
      vgx[8] = 0.1E1*t18*t40*t13;
      vgx[9] = -0.1E1*t18*t40*t9;
      vgx[10] = -0.1E1*t18*t40*t11;
      vgx[11] = -0.1E1*t18*t40*t13;
